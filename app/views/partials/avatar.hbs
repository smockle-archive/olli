<div id="avatar" class="avatar">

  <div class="avatar-btn">
    Need help?
  </div>

  <div class="avatar-bar">
    <span class="avatar-helper-text">Hi! I'm here to help. </span>
    <input type="text" placeholder="Type what you'd like help with, like 'Register' or 'Event list'.">
    <span class="avatar-close">X</span>
  </div>


  <script type="text/javascript" src="scripts/avatar.js"></script>
  <script type="text/javascript">
    (function () {
      setTimeout(function () {
        var a = document.getElementById('avatar')

        a.style.opacity = 0.3;
        setTimeout(function () {
          var a = document.getElementById('avatar')

          a.style.opacity = 1
          a.style.color = '#496e9c'
        }, 2000);
      }, 2000)

      var a = document.getElementById('avatar')
        , btn = a.children[0]
        , bar = a.children[1]

      console.log(a.children)


      //  Opens the avatar helper...
      btn.onclick = function() {
        a.classList.add('avatar--extended')
        bar.classList.add('avatar-bar--visible')
        bar.children[1].focus();
      }
      //  ...and this closes it.
      bar.children[2].onclick = function () {
        a.classList.remove('avatar--extended')
        bar.classList.remove('avatar-bar--visible')
      }
      //  "ENTER" key up event
      bar.children[1].onkeyup = function (e) {
        //  "ESC" key up event:  Closes the avatar if open.
        if(e.keyCode == 27) {
            a.classList.remove('avatar--extended')
            bar.classList.remove('avatar-bar--visible')
        }
        if(e.keyCode == 13) {
          var input = bar.children[1].value

          console.log('input: ' + input)
          // if we recognize the input
          // TODO: write this
          if(matches(input)) {

          }
          else {
            bar.children[0].innerHTML = 'I didn\'t get that.'
            bar.children[1].style.outline = '#f00'
            bar.children[1].value = ''
          }
        }
      }

      var matches = function (i) {

        // # Strategy:
        // Remove unhelpful text. (whitespace, 'help me')
        // Determine all topics that i matches.
        // Pick the one most likely to be desired.
        // OR, if the options are few,
        // Show the user their options.
        // If the chosen topic needs more information,
        //   (e.g. an event or course),
        //   see if there is anything identifying in i.
        //   If not, display the general page for the topic.
        //   Otherwise, display the specific content.

        var register = [
                         'register'
                       , 'join'
                       , 'member'
                       ]
          , events = [
                       'event'
                     ]
          , courses = [
                        'course'
                      , 'class'
                      , 'lecture'
                      ]
          , faq = [
                    'faq'
                  ]
          , garbage = [
                        'help'
                      , 'me'
                      ]



        return false
      }
    })()
  </script>
</div>
